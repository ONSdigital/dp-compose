services:
  dp-api-router:
    extends:
      file: ${PATH_MANIFESTS}/core-ons/dp-api-router.yml
      service: dp-api-router
    environment:
      IDENTITY_API_URL:     "http://dis-authentication-stub:29500"
      ZEBEDEE_URL:          "http://dis-authentication-stub:29500"
      ENABLE_INTERCEPTOR:   "false"
    depends_on:
      zebedee:
        condition: service_healthy
  dis-authentication-stub:
    extends:
      file: ${PATH_MANIFESTS}/stubs/dis-authentication-stub.yml
      service: dis-authentication-stub
    environment:
      DATA_ADMIN_URL: "http://dis-data-admin-ui:29400/data-admin"
  dp-permissions-api:
    extends:
      file: ${PATH_MANIFESTS}/core-ons/dp-permissions-api.yml
      service: dp-permissions-api
    depends_on:
      dp-api-router:
        condition: service_healthy
      mongodb:
        condition: service_healthy
  dp-topic-api:
    extends:
      file: ${PATH_MANIFESTS}/core-ons/dp-topic-api.yml
      service: dp-topic-api
    environment:
      ENABLE_PRIVATE_ENDPOINTS: true
      ZEBEDEE_URL:       "http://dis-authentication-stub:29500"
    depends_on:
      dp-api-router:
        condition: service_healthy
      mongodb:
        condition: service_healthy
  zebedee:
    extends:
      file: ${PATH_MANIFESTS}/core-ons/zebedee.yml
      service: zebedee
    environment:
      IDENTITY_API_URL: "http://dis-authentication-stub:29500"
      ENABLE_PERMISSIONS_API: true
      PERMISSIONS_API_URL: "http://dp-permissions-api:25400"
    depends_on:
      dis-authentication-stub:
        condition: service_healthy
  dis-data-admin-ui:
    extends:
      file: ${PATH_MANIFESTS}/core-ons/dis-data-admin-ui.yml
      service: dis-data-admin-ui
    environment:
      API_ROUTER_URL: "http://dp-api-router:23200/v1"
      MIGRATION_SERVICE_URL: "http://dis-migration-service:30100/v1"
